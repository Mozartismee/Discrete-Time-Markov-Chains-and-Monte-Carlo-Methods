---
created: 2025-10-03 18:49:14
updated: 2025-10-03 18:49:28
---

# 模組 6：Total Variation Norm Distance Between Distributions（全變差距離）

> 主題目標：定義全變差距離（TV 距離），理解離散與連續的等價形式、為什麼會有 $\tfrac12$ 的係數、如何計算與詮釋，並了解它在馬可夫鏈極限定理與收斂速率分析中的角色。

---

## 1. 直觀與用途

- 我們想要量化「兩個機率分布有多不一樣」。  
- TV 距離提供「最壞情況下事件機率差」的度量，範圍在 $[0,1]$：  
  - $0$ 表示兩個分布完全相同；  
  - $1$ 表示兩個分布的支撐幾乎完全不相交（可將其視為「完全區分」）。
- 在馬可夫鏈中，我們會用 TV 距離比較「$n$ 步分布」與「極限／平穩分布」的距離，並據此定義「混合時間」與研究收斂速率。

---

## 2. 定義：離散情形與等價形式

設離散分布 $p$ 與 $q$ 定義在同一可數空間（例如有限集合）上，$p(z)$ 與 $q(z)$ 為質量函數。

- **離散版（常用形）**
  \[
  \|p-q\|_{\mathrm{TV}} \;=\; \frac12 \sum_{z} \big|\,p(z)-q(z)\,\big|.
  \]

- **等價的「最大事件差」形式**
  \[
  \|p-q\|_{\mathrm{TV}} \;=\; \sup_{A}\, \big|\, p(A)-q(A)\,\big|,
  \]
  其中 $A$ 遍歷所有子集合（事件）。

- **等價的「重疊量」形式**
  \[
  \|p-q\|_{\mathrm{TV}} \;=\; 1 - \sum_{z}\min\{p(z),q(z)\}.
  \]
  這個式子特別便於快速心算：重疊越大，距離越小。

> 小結：三個公式彼此等價。$\tfrac12$ 係數的存在使得 TV 距離的範圍自然落在 $[0,1]$，也與「最大事件差」定義配平。

---

## 3. 定義：連續（一般）情形

對一般機率測度（離散或連續），TV 距離定義為
\[
\|\mu-\nu\|_{\mathrm{TV}} \;=\; \sup_{A} \big|\,\mu(A)-\nu(A)\,\big|.
\]

若存在密度 $f,g$（相對於同一底測度，如 Lebesgue 測度）：
\[
\|\mu-\nu\|_{\mathrm{TV}} \;=\; \frac12 \int |f(x)-g(x)|\,dx.
\]

> 為何離散定義有 $\tfrac12$？  
> 因為從「$\sup_A$ 的定義」化簡到「$L^1$ 差的一半」時，恰會產生這個係數。它不是裝飾，而是確保兩種觀點（事件差與密度/質量差）完全一致。

---

## 4. 基本性質

- **值域與極值**：$0\le \|p-q\|_{\mathrm{TV}}\le 1$。支撐不相交則等於 $1$。
- **度量**：滿足非負性、對稱性與三角不等式；$\|p-q\|_{\mathrm{TV}}=0 \iff p=q$。
- **資料處理不等式（收縮性）**：對任意隨機化映射／馬可夫核 $K$，
  \[
  \|pK - qK\|_{\mathrm{TV}} \;\le\; \|p - q\|_{\mathrm{TV}}.
  \]
  直觀：經過相同的隨機化「後處理」，兩分布不會變得更容易區分。
- **耦合表徵（Coupling Lemma）**：在所有耦合 $(X,Y)$ 中，
  \[
  \|p-q\|_{\mathrm{TV}} \;=\; \inf \,\mathbb{P}(X\neq Y).
  \]
  換言之，TV 距離是「最佳耦合下兩者不相等的最小機率」。

---

## 5. 計算與範例（離散）

### 範例 1（同支撐，差異不大）
- $X$ 取 $\{1,2,3\}$，$p=(\tfrac13,\tfrac13,\tfrac13)$；  
- $Y$ 取 $\{1,2,3\}$，$q=(\tfrac12,\tfrac14,\tfrac14)$。
  

計算：
\[
\sum |p-q| \;=\; \Big|\tfrac13-\tfrac12\Big|+\Big|\tfrac13-\tfrac14\Big|+\Big|\tfrac13-\tfrac14\Big|
= \tfrac16+\tfrac1{12}+\tfrac1{12} \;=\; \tfrac13.
\]
故 $\|p-q\|_{\mathrm{TV}}=\tfrac12\cdot\tfrac13=\boxed{\tfrac16}$。

### 範例 2（支撐不同，差異更大）
- $X$ 仍為 $p=(\tfrac13,\tfrac13,\tfrac13)$；  
- $Y$ 僅在 $\{1,2\}$ 上 $q=(\tfrac12,\tfrac12,0)$。

計算：
\[
\sum |p-q| \;=\; \Big|\tfrac13-\tfrac12\Big|+\Big|\tfrac13-\tfrac12\Big|+\Big|\tfrac13-0\Big|
= \tfrac16+\tfrac16+\tfrac13 \;=\; \tfrac23.
\]
故 $\|p-q\|_{\mathrm{TV}}=\tfrac12\cdot\tfrac23=\boxed{\tfrac13}$（比範例 1 更大，合乎直覺）。

### 快速心法
- 用「重疊量」：$\|p-q\|_{\mathrm{TV}}=1-\sum\min\{p,q\}$。  
- 若两分布幾乎不重疊，TV 逼近 $1$；完全一致，TV 為 $0$。

---

## 6. 與馬可夫鏈的關聯

- 若鏈在有限狀態空間**不可約**且**非週期**，則存在唯一不變分布 $\pi$，且對任意初始分布 $\mu$，
  \[
  \|\mu P^n - \pi\|_{\mathrm{TV}} \;\longrightarrow\; 0.
  \]
  這提供了「收斂到極限」的可量化距離。
- **混合時間（鋪墊概念）**：常定義
  \[
  t_{\mathrm{mix}}(\varepsilon)=\min\Big\{n:\ \max_{x}\ \|\delta_x P^{\,n}-\pi\|_{\mathrm{TV}}\le \varepsilon\Big\},
  \]
  用以描述「到多快才算接近平穩」。本模組僅做鋪墊，後續模組會深入速率分析。

> 週期對 TV 的意涵：若鏈具週期（如週期 $2$），則分布會在兩個子支撐間擺盪，TV 距離不一定趨零（即使存在不變分布）。非週期是確保收斂的關鍵條件之一。

---

## 7. 常見陷阱與備忘

- **為何有 $\tfrac12$？**  
  來自「$\sup_A$ 事件差」形式與「$L^1$ 差」形式的等價。對離散情形直接用 $\tfrac12\sum|p-q|$ 計算即可。
- **離散 vs. 連續**：連續時別把點機率當作密度值；應使用積分版 $\tfrac12\int|f-g|$。
- **度量 vs. 規範**：TV 是機率測度空間上的自然度量；在有限集合上等同於一半的 $L^1$ 距離。

---

## 8. 速查清單（實作）

1. **離散小空間**：直接算 $\frac12\sum|p-q|$。  
2. **先看重疊**：若支撐幾乎不重疊，TV 近 $1$；快速估算用 $1-\sum\min\{p,q\}$。  
3. **馬可夫鏈應用**：比較 $\mu P^n$ 與 $\pi$ 的 TV 距離，觀察是否遞減與趨零。  
4. **資料處理**：經相同轉移（核）後，距離不會放大。

---

## 9. 小練習（自我檢核）

- 計算 $\|(\tfrac{2}{3},\tfrac{1}{3},0)-( \tfrac{1}{2},\tfrac{1}{2},0)\|_{\mathrm{TV}}$。  
- 設 $p=(0.4,0.4,0.2)$、$q=(0.2,0.3,0.5)$，用兩種方式計算 TV：  
  (a) $\tfrac12\sum|p-q|$，(b) $1-\sum\min\{p,q\}$，驗證一致。  
- 令 $\mu$ 為某初始分布，$\pi$ 為平穩分布。對不可約非週期鏈，試畫出數個 $n$ 的 $\|\mu P^n-\pi\|_{\mathrm{TV}}$ 估計值，觀察其遞減趨勢。

---

## 10. 一句話總結
TV 距離衡量「兩個分布在最壞事件上的機率差」，離散可用 $\tfrac12\sum|p-q|$ 快算；在馬可夫鏈中，它是描述「從 $n$ 步分布到極限分布有多近」的標準尺。