---
created: 2025-10-03 18:48:49
updated: 2025-10-03 18:48:56
---

# 模組 3：Limiting Distributions and Classification of States（完整筆記）

> 適用對象：離散時間、齊次馬可夫鏈（可數或有限狀態）。  
> 標準記號：$P=[p_{ij}]$、$p^{(n)}_{ij}=\Pr(X_n=j\mid X_0=i)$、CK 方程：$P^{m+n}=P^mP^n$。

---

## 1. Introduction to Limiting Distributions

### 1.1 直觀出發：矩陣冪與「長期穩定」
- 觀察 $P^n$ 的列（或行）隨 $n$ 增長是否**趨於常數向量**（各列相同）。  
- 當收斂存在且與起點無關，稱存在**極限分布**；等價表示：
  $$
  \lim_{n\to\infty}P^n=\mathbf{1}\,\pi^\top,\quad \pi^\top P=\pi^\top,\ \sum_j\pi_j=1.
  $$
- 但僅看數值收斂不可靠；需結構性條件（見 §5）。

### 1.2 Communication Classes for a Markov Chain（通信類）
- **可達**：$i\to j$ 若 $\exists n\ge0$ 使 $p^{(n)}_{ij}>0$。特別地 $i\to i$ 因為 $p^{(0)}_{ii}=1$。
- **通信**：$i\leftrightarrow j \iff i\to j\ \&\ j\to i$。  
  是**等價關係**（反身、對稱、傳遞），將狀態空間分割為**通信類**。
- **閉類（closed class）**：類內無法以正機率離開至類外。
- **要點**  
  - 有限閉類中的所有狀態皆為**再返**（recurrent）。  
  - 若全鏈僅一個通信類 ⇒ **不可約**（irreducible）。

---

## 2. Classification of States

### 2.1 Recurrence and Transience（再返與暫留）
- **回返時間**：$T_i=\min\{n\ge1: X_n=i\}$。
- **回返機率**：$f_{ii}=\Pr_i(T_i<\infty)$。
- **分類**：  
  再返（recurrent）$\Leftrightarrow f_{ii}=1$；暫留（transient）$\Leftrightarrow f_{ii}<1$。  
  同一通信類內，型態一致（類性質；證明見 §3.2）。

### 2.2 Expected Number of Returns to a Transient State（暫留狀態的回返次數）
- 令
  $$
  N_i=\sum_{n\ge1}\mathbf{1}_{\{X_n=i\}}\quad(\text{回到 }i\text{ 的總次數，不含 }n=0).
  $$
- 若 $i$ 暫留（$f_{ii}<1$），則
  $$
  \mathbb{E}_i[N_i]=\frac{f_{ii}}{1-f_{ii}},\qquad
  \sum_{n\ge0}\Pr_i(X_n=i)=\frac{1}{1-f_{ii}}\;(\text{含初始時刻}).
  $$
- 觀念：暫留 ⇒ 終會離開且不返；但離開前回返次數的期望是有限的幾何型值。

### 2.3 Classification of States（全貌）
- 每個通信類要麼**再返類**、要麼**暫留類**。  
- **有限鏈**：至少存在一個再返狀態；若不可約 ⇒ 全部再返。  
- 再返再細分（§4, §5）：**正再返**（期望回返時間有限）與**零再返**（期望回返時間無限）。

---

## 3. Recurrence and Transience，A Deeper Dive

### 3.1 Alternative Characterization（級數刻畫）
**定理**  
$$
i\ \text{再返}\ \Longleftrightarrow\ \sum_{n=1}^{\infty}p^{(n)}_{ii}=\infty;\qquad
i\ \text{暫留}\ \Longleftrightarrow\ \sum_{n=1}^{\infty}p^{(n)}_{ii}<\infty.
$$
**證明骨架**：設 $N_i=\sum_{n\ge1}\mathbf{1}_{\{X_n=i\}}$。則
$\mathbb{E}_i[N_i]=\sum_{n\ge1}\Pr_i(X_n=i)=\sum_{n\ge1}p^{(n)}_{ii}$。  
再返 ⇔ 期望訪問和發散；暫留 ⇔ 收斂。（用指示函數期望 $=$ 機率、期望線性性。）

### 3.2 Recurrence and Transience are Class Properties（類性質證明）
**目標**：若 $i\leftrightarrow j$，則 $i$ 再返 $\Leftrightarrow$ $j$ 再返。  
**關鍵不等式（CK 的「雙停靠」版）**  
若 $\exists m,n$ 使 $p^{(m)}_{ji}>0,\ p^{(n)}_{ij}>0$，則對任意 $k\ge1$
$$
p^{(m+k+n)}_{jj}\ \ge\ p^{(m)}_{ji}\,p^{(k)}_{ii}\,p^{(n)}_{ij}.
$$
兩側對 $k$ 求和：若 $\sum_k p^{(k)}_{ii}=\infty$（$i$ 再返），則 $\sum_t p^{(t)}_{jj}=\infty$（$j$ 再返）。  
暫留類性質由對偶論證得出。

---

## 4. The Random Walk（整數上的簡單隨機漫步）

- 狀態：$\mathbb{Z}$；每步 $+1$ 機率 $p$、$-1$ 機率 $1-p$；不可約；**週期 2**。  
- 回到 0 必為偶數步：
  $$
  p^{(2n)}_{00}=\binom{2n}{n}p^n(1-p)^n,\quad p^{(2n+1)}_{00}=0.
  $$
- **Stirling 近似**：$\binom{2n}{n}\sim \dfrac{4^n}{\sqrt{\pi n}}$。  
  $$
  p^{(2n)}_{00}\sim \frac{\bigl(4p(1-p)\bigr)^n}{\sqrt{\pi n}}.
  $$
- **分類結論**  
  - $p=\tfrac12$：$\sum_n p^{(2n)}_{00}$ 與 $\sum n^{-1/2}$ 同階 ⇒ **再返**，且 $\mathbb{E}_0[T_0]=\infty$ ⇒ **零再返**。  
  - $p\ne\tfrac12$：$\sum_n p^{(2n)}_{00}<\infty$ ⇒ **暫留**（有漂移）。

---

## 5. Existence and Uniqueness of the Limiting Distribution

### 5.1 週期與非週期
- **週期**：$d(i)=\gcd\{n\ge1:\ p^{(n)}_{ii}>0\}$，為類性質。$d(i)=1$ ⇒ 非週期。
- 快速判定（有限不可約鏈）：若存在 $i$ 使 $p_{ii}>0$ ⇒ 全鏈非週期。

### 5.2 主定理（存在性與唯一性）
**遍歷鏈極限定理**  
若鏈**不可約 + 正再返 + 非週期**，則存在唯一不變分布 $\pi$，且
$$
\lim_{n\to\infty}p^{(n)}_{ij}=\pi_j\quad(\forall i,j),\qquad
P^n\to \mathbf{1}\pi^\top.
$$
- **有限鏈推論**：有限 $+$ 不可約 ⇒ 正再返；若再非週期 ⇒ 立得上式。
- **返時表示**：$\displaystyle \pi_j=\frac{1}{\mathbb{E}_j[T_j]}$。  
  若 $j$ 零再返，$\mathbb{E}_j[T_j]=\infty$ ⇒ $\pi_j=0$。

### 5.3 可約反例（為何不可約很重要）
- 若存在多個閉類：每個閉類內各自收斂到本類的 $\pi^{(C)}$，**全域極限分布依初始所屬閉類而異**，不具「起點無關」性。

---

## 6. Total Variation Norm Distance Between Distributions

### 6.1 離散情形
- 對兩個 pmf $f,g$：
  $$
  \|f-g\|_{\mathrm{TV}}=\frac12\sum_{z}|f(z)-g(z)|\in[0,1].
  $$
- 解讀：半個 $L^1$ 距離；衡量兩分布的最大機率差異。

### 6.2 一般測度定義
$$
\|\mu-\nu\|_{\mathrm{TV}}=\sup_{A}|\mu(A)-\nu(A)|.
$$
離散情形化簡為 $\tfrac12\sum|f-g|$，**$\tfrac12$** 因子源自此一般定義。

### 6.3 在馬可夫鏈中的用途
- 用於衡量 $n$ 步分布與極限分布的距離：$\|\mathcal{L}(X_n)-\pi\|_{\mathrm{TV}}\to 0$。  
- 為後續「收斂速率 / 混合時間」的核心度量（本模組先建立定義與直覺）。

---

## 附：實作檢核清單（從矩陣到結論）

1) **通信類**：判斷可達/通信、分解強連通分量；找出閉類。  
2) **再返型態**：有限閉類 ⇒ 再返；有限不可約 ⇒ 全部再返且正再返。  
3) **週期**：計算 $d(i)$；有限不可約只要見 $p_{ii}>0$ 即非週期。  
4) **遍歷條件**：不可約 + 正再返 + 非週期 ⇒ 極限分布存在且唯一、與起點無關。  
5) **求 $\pi$**：解 $\pi^\top P=\pi^\top,\ \sum\pi=1$；或用 $\pi_j=1/\mathbb{E}_j[T_j]$ 作直覺檢核。  
6) **（可選）距離**：用 TV 距離觀察 $n$ 步與 $\pi$ 的差異，以備後續收斂速率分析。

---

## 速記總結（一頁式）

- 再返$\Leftrightarrow\sum_{n\ge1}p^{(n)}_{ii}=\infty$；暫留$\Leftrightarrow$收斂。  
- 暫留/再返/正零再返/週期皆為**類性質**。  
- 有限不可約 ⇒ 正再返；再加非週期 ⇒ $P^n\to \mathbf{1}\pi^\top$。  
- $\pi_j=1/\mathbb{E}_j[T_j]$（零再返時為 0）。  
- SRW on $\mathbb{Z}$：$p=1/2$ 再返但零再返；$p\ne1/2$ 暫留。  
- TV 距離：$\|f-g\|_{\mathrm{TV}}=\tfrac12\sum|f-g|$，評估「離穩態有多遠」。